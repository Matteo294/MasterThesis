% !TeX root = ../main.tex

\chapter{Methods and algorithms}
\label{chapt:methods}

\section{Discretisation of the Yukawa theory}
\label{sec:lattice_discretisation}

In this secttt we provide a discretised formulation of the Yukawa model introduced in section \ref{subsec:Yukawa_theory}. \\~\\
For what concerns the bosonic part of the action, a discretisation can be done straightforwardly with the following replacements
\begin{equation*}
    \begin{aligned}
        \int_x \qquad &\to \qquad a^2 \sum_x \\
        \partial^2_x = \frac{\partial^2}{\partial t^2} + \frac{\partial^2}{\partial x_1^2} \qquad &\to \qquad \sum_\mu \left[\frac{\delta_{m,n+\mu} + \delta_{m,n-\mu} - 2 \delta_{m,n}}{a^2}\right]
    \end{aligned}
\end{equation*}
which yields to the lattice action
\begin{equation*}
        S_\phi [\phi] =  a^2 \sum_{m,n} \phi_m \, K_{mn} \, \phi_n + \frac{\lambda}{4!} \, \sum_n \phi_n^4 
\end{equation*}
with 
\begin{equation*}
    K_{mn} = - \sum_\mu \left[\frac{\delta_{m,n+\mu} + \delta_{m,n-\mu} - 2 \delta_{m,n}}{a^2}\right] + m_\phi^2 \delta_{mn} 
\end{equation*}
One can also express everything using dimensionless coupdlings
\begin{equation}
    \begin{aligned}
        \hat m_\phi^2 &= a^2 \, m_\phi^2 \\
        \hat \lambda &= a^{2} \, \lambda, \\
        \hat K_{mn} &= a^2 K_{mn}
    \end{aligned}
    \label{eq:couplings_redefitinion}
\end{equation}
and the action is then described only in terms of dimensionless quantities
\begin{equation*}
    S_\phi=-\sum_{n, \mu} \hat\phi_n \hat\phi_{n+\mu}+\sum_n\left[\frac{1}{2}\left(4+\hat m^2\right) \hat\phi_n^2 +\frac{\hat\lambda}{4 !} \, \hat\phi_n^4\right]
\end{equation*}
\textcolor{red}{Otherwise it is customary to introduce dimensionless couplings $\kappa, \beta$ defined via
\begin{equation}
    \begin{aligned}
       \phi & \rightarrow(2 k)^{\frac{1}{2}} \phi, \\
        (a m)^2 & \rightarrow \frac{1-2 \beta}{k}-4, \\
        a^{-2} \lambda & \rightarrow \frac{6 \beta}{k^2}
    \end{aligned}
    \label{eq:dimless_couplings_defitinion}
\end{equation}
and the equivalent action reads
\begin{equation*}
    S_{\phi}=-2 k \sum_{n, \mu} \phi_n^i \phi_{n+\mu}^i+(1-2 \beta) \sum_n \phi_n^i \phi_n^i+\beta \sum_n\left(\phi_n^i \phi_n^i\right)^2
\end{equation*}
In the following, we might use any of the two dimensionless formulations interchangeably, since they are completely equivalent given the definitions \eqref{eq:couplings_redefitinion}, \eqref{eq:dimless_couplings_defitinion}.} \\
For what concerns the fermionic action, a naive discretisation is not sufficient, due to the well known doubling problem. In this work Wilson fermions are employed as a way to fix such issue. Details of this formulation are explained in section \ref{AppendixB}. Here, only the final discretised action is reported, which reads
\begin{equation*}
    S_\psi[\phi, \psi, \bar\psi] = \sum_{m,n} \bar\psi_m \, D_{m,n} \psi_n + g \, \sum_n \bar\psi_n \phi_n \psi_n
\end{equation*}
with $\psi_n$ beeing a four-component spinor (2 flavour components and 2 Dirac components), and $D_{m,n}$ beeing the Wilson-Dirac operator \note{is $g\phi$ included in the definition of $D$?)} defined as 
\begin{equation}
    \begin{aligned}
    D_{m, n} = &- \left(\frac{\Gamma_{+0}}{2} \, \delta_{m, m+0} +\frac{\Gamma_{-0}}{2} \, \delta_{m, m-0} + \frac{\Gamma_{+1}}{2} \, \delta_{m, m+1} + \frac{\Gamma_{-1}}{2} \, \delta_{m, m-1}\right) \, \delta _{f, f'} \\
     &+ \left(2 + m + g\phi\right) \ \delta_{s,s'} \delta_{m,n} \\
    \end{aligned}
    \label{eq:wilson-dirac_operator}
\end{equation}
The Wilson projectors $\Gamma_{\pm \mu}$ are defined as
\begin{equation*}
    \Gamma_{\pm \mu} = 1 \mp \gamma_\mu 
\end{equation*}
One can then proceed by defining dimensionless fields and couplings
\begin{equation*}
    \begin{aligned}
        \hat\psi &= \rightarrow a^{\frac{1}{2}} \psi, \\
        \hat m_q &= a m_q, \\
        \hat g &= a g
    \end{aligned}
    \label{eq:fermionic_theory_dimless_redefinitions}
\end{equation*}
to describe the action only in terms of dimensionless quantities. \\
In the remaining of this work, the dimensionless couplings and fields will be adopted, unless otherwise specified. Additionally, both the original action $S$ and the effective action $S_\text{eff}$ will be denoted by $S$ for simplicity. It will be clear from the context to which of the two we will be referring. \\


\section{Langevin equation}
In order to compute expectation values from the discretised path integral \textcolor{red}{add ref.} we employ a Langevin Monte Carlo algorithm, which is based on stochastic quantisation \cite{ParisiWu, Damgaard1987StochasticQuantization}. \\
The idea is that Euclidean Quantum Field theory can be thought as a system in thermal equilibrium with a heat reservoir and hence described as a stochastic process via the Langevin equation. \\
Let us consider a scalar field $\phi$ with a Euclidean action $S[\phi]$ and the following Langevin equation
\begin{equation}
    \partial_\tau \phi(\tau, x) = - \frac{\delta S[\phi]}{\delta \phi (\tau, x)} + \eta (\tau, x)
    \label{eq:Langevin_scalar_full}
\end{equation}
where $- \frac{\delta S[\phi]}{\delta \phi (\tau, x)}$ is the drift term and $\eta (\tau, x)$ is a random white noise field defined by
\begin{equation*}
    \expect{\eta(x,\tau)} = 0 \qquad \expect{\eta(x,\tau) \, \eta(x',\tau')} = 2 \, \delta(x, x') \, \delta (\tau, \tau')
\end{equation*}
For $t \to +\infty$ \textcolor{red}{(assuming a stationary solutions exists, but I think it is always the case if the action is bounded from below)} one can prove that \textcolor{red}{ADD CITATION} the stationary probablity distribution is given by
\begin{equation}
    \mathcal{P}(\phi) = \frac{1}{Z} \, \exp\left(-S[\phi])\right)
    \label{eq:probability_field_configuration_full}
\end{equation}
This allow one to compute correlation functions as moments of the distribution \eqref{eq:probability_field_configuration_full}. \\
Equation \ref{eq:Langevin_scalar_full} can be integrated numerically for discrete time steps $\tau_n$ via, for example, an explicti Euler-\textcolor{red}{Someone Else} scheme
\begin{equation*}
    \phi(\tau_{n+1}, x) = \phi(\tau_{n}, x) - \epsilon \,  \frac{\delta S[\phi]}{\delta \phi (\tau_n, x)} + \sqrt{2\epsilon} \, \eta(\tau_n, x)
\end{equation*}
Higher order integration schemes are, for example, \textcolor{red}{cite schemes}.
For the discretised action of the Yukawa theory the drift reads
\begin{equation}
    \begin{aligned}
        \frac{\partial S}{\partial \phi(\tau_n,m)} &= \frac{\partial S_\phi}{\partial \phi(\tau_n, m)} - \underset{s,f}{\tr} \left[D^{-1} \frac{\partial D(\phi)}{\partial \phi(\tau_n, m)}\right] \\
        &= \frac{\partial S_\phi}{\partial \phi(\tau_n, m)} - g \, \underset{s,f}{\tr} \left[D^{-1}(\phi(\tau_n,m))\right]
    \end{aligned}
    \label{eq:drift_continuum_full_theory}
\end{equation}
To evaluate the trace, which is due to the fermionic contribution, we use the bilinear noise scheme \textcolor{red}{add reference} which is illustrated in Appendix \ref{AppendixC}.



\section{Coloured noise}
\label{sec:coloured_noise}
\note{Mention some possible uses of colored noise beside taking continuum limits.} \\
Connection to stochastic regularisation \cite{}
In the stochastic quantisation procedure the noise which accounts for the quantum fluctuations of the theory is assumed to be white noise. This means that its power spectrum is flat in momentum space, extending in all the first Brillouin zone, namely for $p_\mu \in [-\pi/a, \pi/a]$. One could modify this spectrum, and in this case one says \emph{colored noise}. In particular one could put a sharp cutoff on the total momentum, imposing $p^2 \leq \Lambda^2$. We refer to this particular case as \emph{regularised noise}. \\
In such case the Langevin equation for the scalar field \eqref{eq:Langevin_scalar_full} assumes the form
\begin{equation*}
    \partial_\tau \phi(\tau, x) = - \frac{\delta S[\phi]}{\delta \phi (\tau, x)} + r_\Lambda (x) \, \eta (\tau, x)
    \label{eq:Langevin_scalar_regularised}
\end{equation*}
where the regularising function $r_\Lambda(x)$ can be easilly expressed in momentum space as $r_\Lambda(p) = \theta(\Lambda^2 - p^2)$. One can show \cite{Pawlowski2017CoolingNoise} that the stochastic process is now driven towards a new equilibrium distribution
\begin{equation}
    \mathcal{P}_\Lambda(\phi) = \frac{1}{Z} \, \exp\left(-S_\Lambda[\phi])\right) = \frac{1}{Z} \, \exp\left(-(S[\phi] + \Delta S_\Lambda[\phi])\right)
    \label{eq:probability_field_configuration_regularised}
\end{equation}
where the correction term $S_\Lambda[\phi]$ ensures that the probability measure $\mathcal{P}_\Lambda$ vanishes for squared fields' momenta greater than the cutoff $\Lambda^2$. \\
An explicit example of such regulator for a free scalar field can be \textcolor{red}{ADD EQUATION PAWLOWSKI}.
This is just one example of regularisation and different ones can be chosen. See \cite{Pawlowski2017CoolingNoise} for details.


\section{Lattice QFT with regularised noise}
After the general introduction on coloured noise given in the previous paragraph, let us now look more closely on the lattice formulation and at the various applications of such techniques.
From a code perspective, the algorithm to regularise noise with a sharp cutoff is presented in Appendix WHICH ONE?. \\
Let us consider a squared two-dimensional lattice with size $L \equiv L_x = L_y$ and spacing $a \equiv a_x = a_y$. This implies a maximum momentum $p_\text{max} = \pi / a$ in each space-time direction. We consider a regularised simulation with cutoff $\Lambda'$. Let us also define $\Lambda^2 \equiv (p^x_\text{max})^2 + (p^y_\text{max})^2$. At this point we introduce a parameter, called \emph{cutoff fraction}, defined as $s^2 \equiv \Lambda^2 / \Lambda'^{\,2}$. With this notation, $s=1$ is the full white noise case, while for any regularised noise one has $0 < s < 1$. \\
We now want to address the following question: given the stationary probability distribution \ref{eq:probability_field_configuration_regularised}, is it possible to compensate the change in physical observables caused by the removal of the quantum modes via regularised noise, by a rescaling of the bare parameters that enter the lattice discretised action? Remembering from sections \ref{sec:lattice_discretisation} and \ref{sec:continuum_limit} that $\Lambda \sim a^{-1}$, this question would also address the problem of continuum limit of effective field theories. In fact the question we want to address is completely equivalent to the following: can one compensate a change in the spacing (controlled by the bare parameters), by a change of the noise in the simulation, in order to keep physical observables constant?\\
To this end, let us consider a noise regularisation given by $s^2 = \Lambda^2 / \Lambda'^{\,2} < 1$ ($s = a' / a < 1$), which means a higher cutoff (a smaller spacing $a'$). We now introduce an approximate ansatz which is based on the analogy to standard block-spin transformations. Higher order corrections to this simple ansatz are discussed in WHICH SECTION? \\
A change in the spacing $a \to ra$ will cause the following
One then accomodates the change of the spacing (cutoff) by a change in the bare dimensionful couplings, as explained in chapter \ref{chap:theoretical_background}. At lowest order one can perform standard block spin step, which corresponds to a tree level analysis in the wilsonian perspective. This means that all the dimensionful quantities, couplings, momenta, fields, have to be rescaled according to their dimension, as detailed in the following lines. \\
For what concerns the scalr part of the action, the rescaling at tree level is rather trivial 
\begin{equation*}
    (a^2m_\phi^2) \to s^2(a^2m_\phi^2), \quad (a^2\lambda) \to s^2 (a^2\lambda), \quad \phi \to \phi \quad
\end{equation*}
The fermionic part needs some more careful analysis. 
In a lattice simulation one wants to perform the integral over the fermionic fields and works with the effective action \eqref{eq:effective_action_no_fermions}. In this case the drift is given by equation \eqref{eq:drift_continuum_full_theory}, with the fermionic contribution beeing
\begin{equation*}
    K_{\psi} = g \, \underset{s,f}{\tr}{D^{-1}}
\end{equation*}
or, in terms of dimensionless quantities
\begin{equation*}
    \widehat{K}_{\psi} = (ag) \, \underset{s,f}{\tr}{(aD)^{-1}}
\end{equation*}
This implies that under a lattice block-spin transformation, where $a \to sa$,
\begin{equation}
    \widehat{K}_{\psi} \to  (sag) \, \underset{s,f}{\tr}{(saD)^{-1}} = \widehat{K}_{\psi}
    \label{eq:fermionic_rescaling_naive}
\end{equation}
On the other side, when computing the fermionic contribution to the drift via the original action \eqref{eq:full_action_continuum}, one gets
\begin{equation*}
    \begin{aligned}
        K(\tau, x) &= - \frac{\delta S}{\delta \phi(\tau, x)} = K_\phi(\tau, x) - g \, \bar\psi(\tau, x)\psi(\tau,x) = \\
        &= -\left(-\partial_x + m_\phi^2\right) \phi - \frac{\lambda}{6} \, \phi^3 - g \, \bar\psi\psi
    \end{aligned}
    \label{eq:drift_continuum_from_full_action}
\end{equation*}
where the fermionic contribution is 
\begin{equation*}
    g \, \bar\psi\psi
\end{equation*}
Note that all the terms in the equation \eqref{eq:drift_continuum_from_full_action} have dimension 2, in units of energy, which means, in particular, that after a lattice block-spin transformation where $a \to sa$, one has
\begin{equation}
    \widehat{K}'_\psi = (ag) (a\bar\psi \psi) \to s^2 (ag) (a\bar\psi \psi) = s^2 \widehat{K}'_\psi
    \label{eq:rescaling_blinear}
\end{equation}
in contrast with \eqref{eq:fermionic_rescaling_naive}. For this reason, in order to have the correct scaling, we compute the contribution to the drift using \eqref{eq:fermionic_rescaling_naive} without rescaling the Dirac operator (and hence the Yukawa coupling), and then rescale the whole drift via 
\begin{equation*}
    \widehat{K}_\psi \to s^2 \widehat{K}_\psi
\end{equation*}
mathing the scaling of the other quantities in the drift. \\
\textcolor{red}{Mention that this could mean that for a higher order rescaling one might have to look at how the quark bilinear renormalises.}

\newpage 
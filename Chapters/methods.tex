% !TeX root = ../main.tex

\chapter{Methods and algorithms}
\label{chapt:methods}

\section{Discretisation of the Yukawa theory}
\label{sec:lattice_discretisation}
In order to make the theory suitable for a numerical simulation on a computer, the continuum formulation of the Yukawa model, which has been introduced in section \ref{sec:Yukawa_theory}, has to be discretised. Here we provided a sketch of a discretisation procedure, and we refer to other resources \cite{rothe_LGT,gattringer_LQCD,creutz_2023,Montvay1994QuantumLattice} for further details. \\~\\
For what concerns the bosonic part of the action, a discretisation can be done straightforwardly with the following replacements
\begin{equation*}
    \begin{aligned}
        \int d^x \quad &\to \quad a^2 \sum_x, \\
        \partial^2_t + \partial^2_x = \frac{\partial^2}{\partial t^2} + \frac{\partial^2}{\partial x_1^2} \quad &\to \quad \sum_\mu \left[\frac{\delta_{m,n+\mu} + \delta_{m,n-\mu} - 2 \delta_{m,n}}{a^2}\right],
    \end{aligned}
\end{equation*}
which yields to the lattice action
\begin{equation*}
        \begin{aligned} 
        		S_\phi [\phi] 	&=  a^2 \left( \frac{1}{2} \, \sum_{m,n} \phi_m \, K_{mn} \, \phi_n + \frac{\lambda}{4!} \, \sum_n \phi_n^4 \right)\\
        					&=  \frac{1}{2} \, \sum_{m,n} \hat{\phi}_m \, \widehat{K}_{mn} \, \hat{\phi}_n + \frac{\hat{\lambda}}{4!} \, \sum_n \hat{\phi}_n^4,
	\end{aligned}
\end{equation*}
where we expressed everything in dimensionless quantities
\begin{equation}
    \begin{aligned}
        \hat m_\phi^2 &= a^2 \, m_\phi^2, \\
        \hat \lambda &= a^{2} \, \lambda, \\
        \widehat{K}_{mn} &= a^2 K_{mn}.
    \end{aligned}
    \label{eq:couplings_redefitinion}
\end{equation}
The operator components $\widehat{K}_{mn}$ are the discretised version of \eqref{eq:definition_kinetic_terms_continuum_position}
\begin{equation}
    \widehat{K}_{mn} = - \sum_\mu \left[\delta_{m,n+\mu} + \delta_{m,n-\mu} - 2 \, \delta_{m,n}\right] + \hat{m}_\phi^2 \, \delta_{mn} 
    \label{eq:discretised_kinetic_op_bosons}
\end{equation}
and its representation in momentum space is
\begin{equation*}
	\begin{aligned}
		\widehat{K}_{p, q} & =\sum_{n, m} e^{i p n} \, \widehat{K}_{n m} \, e^{-i q m} \\
		& =\sum_{n, m} e^{i p n}\left(-\sum_\mu\left[\delta_{m,m+\mu}+\delta_{m,m-\mu}-2 \delta_{m, n}\right] + \hat{m}_\phi^2 \, \delta_{mn}\right) e^{-i q m} \\
		& =\sum_{n} e^{i(p-q) n}\left[\hat{m}_\phi^2+2\sum_\mu \left(1-\cos \left(q_\mu\right)\right)\right] \\
		& = \left[\hat{m}_\phi^2 + \sum_\mu 4 \sin ^2\left(\frac{p_\mu}{2}\right) \right] \, \delta(p-q) .
	\end{aligned}
\end{equation*}
For what concerns the fermionic action, a na\"ive discretisation is not sufficient, due to the well known doubling problem \cite{rothe_LGT,Montvay1994QuantumLattice}. In this work Wilson fermions \cite{wilson_lqcd} are employed as a way to fix such issue. Details of this formulation are explained in Appendix \ref{chap:AppendixB}. Here, only the final discretised action is reported, which reads
\begin{equation}
		S_\psi\left[\psihat, \psibarhat \right] + S_\text{int}\left[\phihat, \psihat, \psibarhat \right] = \sum_{f=1}^{N_f}\hat{\bar{\psi}}_m^{(f)} \, \widehat{D}_{mn} \, \hat{\psi}_n^{(f)},
\end{equation}
with $\psi_n$ beeing a two-component spinor, and $\widehat{D}_{m,n}$ the Wilson-Dirac operator \textcolor{blue}{(can I include $g\phi $ in the definition of $D$?)} defined as 
\begin{equation}
    \begin{aligned}
    \widehat{D}_{m, n} = &- \left(\frac{\Gamma_{+\hat 0}}{2} \, \delta_{m, m+\hat 0} +\frac{\Gamma_{-\hat 0}}{2} \, \delta_{m, m-\hat 0} + \frac{\Gamma_{+\hat 1}}{2} \, \delta_{m, m+\hat 1} + \frac{\Gamma_{- \hat 1}}{2} \, \delta_{m, m-\hat 1}\right)  \\
     &+ \left(2ar + \hat m + \hat g \phi\right) \, \delta_{s,s'} \, \delta_{m,n}. \\
    \end{aligned}
    \label{eq:wilson-dirac_operator}
\end{equation}
Note that the interaction term $g\, \bar\psi\phi\psi$ has been included in the definition of $D$. \\
The Wilson projectors $\Gamma_{\pm \hat \mu}$ are defined as
\begin{equation*}
    \Gamma_{\pm \hat \mu} = ar \, \mathds{1}_s \mp \gamma_\mu.
\end{equation*}
Since $r \in [0,1]$ is a free parameter, in this work we set $r=1$, if not otherwise specified. \\
In summary the discretised action for the Yukawa model is 
\begin{equation*}
    S\left[\phihat, \psihat, \psibarhat \right] = \sum_{m,n} \, \hat{\phi}_m \, \widehat{K}_{m,n} \, \hat{\phi}_n + \frac{\hat{\lambda}}{4!} \, \hat{\phi}_m^{\,4} \, \delta_{m,n} + \sum_{f=1}^{N_f}\psibarhat_m^{(f)} \, \widehat{D}_{mn} \psihat_n^{(f)},
\end{equation*}
with $\widehat{K}_{mn}, \widehat{D}_{mn}$ given respectively by \eqref{eq:discretised_kinetic_op_bosons} and \eqref{eq:wilson-dirac_operator}. \\
For later reference, we also report the discretised version of the effective action \eqref{eq:effective_action_no_fermions}
\begin{equation}
	\begin{aligned}
		S_\text{eff}[\hat\phi] 	&= S_\phi[\hat\phi] - N_f \trover{n,s} \log \widehat{D} \\
							&= \sum_{m,n} \, \hat{\phi}_m \, \widehat{K}_{m,n} \, \hat{\phi}_n + \frac{\hat{\lambda}}{4!} \, \hat{\phi}_m^{\,4} \, \delta_{m,n} - N_f \trover{n,s} \log \widehat{D}_{nn}.
	\end{aligned}
	\label{eq:discretised_effective_action}
\end{equation}
The full discrete path-integral reads \textcolor{red}{(measure over dimless or dimful?)}
\begin{equation}
    Z = \int \prod_n d\hat\phi_n \ e^{-S_\text{eff}[\hat\phi]}.
    \label{eq:discretised_path_integral}
\end{equation}
In the remaining of this work, both the original action $S$ and the effective action $S_\text{eff}$ will be denoted by $S$ for simplicity. It will be clear from the context which of the two we will be referring to.

\section{Langevin Monte Carlo}
The relations \eqref{eq:probability_field_configuration_full,eq:expectation_observables} suggest that equation \eqref{eq:Langevin_scalar_full} can be integrated numerically for discrete time steps $\tau_n$ to generate field configurations distributed according to \eqref{eq:probability_field_configuration_full}. 
The simplest first-order integration algorithm is the Euler-Majorana scheme \cite{ParisiWu}
\begin{equation*}
    \phi(\tau_{n+1}, x) = \phi(\tau_{n}, x) - \epsilon \,  \frac{\delta S[\phi]}{\delta \phi (\tau_n, x)} + \sqrt{\epsilon} \, \eta(\tau_n, x) + O(\epsilon^2),
\end{equation*}
where $\epsilon = \tau_{n+1} - \tau_n$. Higher order integration schemes are possible (see e.g.\cite{bilinearnoise1,Kronfeld1993}), but not adopted in this work, and an adaptive step size is employed as detailed in Appendix \ref{chap:AppendixC}.
In this way, for any observable $O$, one can introduce a Monte-Carlo estimator $\expect{O}_*$ which converges to the expectiation value given by \eqref{eq:expectation_observables} in the limit of infinite samples
\begin{equation}
    \expect{O}_{*} = \frac{1}{N_\text{samp}} \sum^{N_\text{samp}}_{i=1} O_i \quad \underset{N_\text{samp} \to \infty}{\longrightarrow} \quad \expect{O} = \frac{1}{Z} \, \int D\phi \ O(\phi) \, \exp\left(-S[\phi]\right),
    \label{eq:monte_carlo_estimator}
\end{equation}
where $O_i = O(\phi(\tau_i))$ is the sample of the observable $O$ done at time $\tau_i$. \\~\\
For the discretised action of the Yukawa theory \eqref{eq:discretised_effective_action} the drift reads, explicitly,
\begin{equation}
    \begin{aligned}
        \frac{\partial S}{\partial \phihat_m(\tau_n)} &= \frac{\partial S_{\phihat}}{\partial \phihat_m(\tau_n)} - N_f \, \underset{s}{\tr} \left[\sum_{j,k} \widehat{D}^{-1}_{jk}  \, \frac{\partial \widehat{D}_{kj}(\phihat)}{\partial \phihat_m(\tau_n)}\right] \\
        &= \sum_l \widehat{K}_{ml} \, \hat\phi_l + \frac{\hat\lambda}{6} \, \hat\phi_m^3 - \hat g \, N_f \, \underset{s}{\tr} \left[(\widehat{D}_{mm})^{-1}(\phihat(\tau_n))\right].
    \end{aligned}
    \label{eq:drift_continuum_full_theory}
\end{equation}
While the bosonic contribution can be computed in a straightforward manner, the computation of the fermionc contribution requires the inversion of the Dirac operator. This, in general, cannot be done straightforwardly, mainly due to computational reasons.
In fact, the full Dirac operator would be a $(2 \cdot N_t \cdot N_x \cdot N_f)^2$ dimensional object and a full inversion would be very expensive. In fact, $D^{-1}$ has to be recomputed at every step and the best available algorithm as today for the matrix inversion has a computational complexity of $O(n^{2.371552})$ \cite{williams2023new}. To circumvent this, we use the bilinear noise scheme \cite{bilinearnoise1,bilinearnoise2} \textcolor{blue}{should I cite here or in Appendix?} which is illustrated in Appendix \ref{chap:AppendixC}.




\section{Applications of coloured noise in lattice QFT}
\label{sec:lattice_with_coloured_noise}

\subsection*{Cooling and the continuum limit}
After the general introduction on coloured noise given in the previous paragraph, let us now look more closely on the lattice formulation and at some possible applications of the technique. \\~\\
To this end, let us consider a two-dimensional lattice with side lengths $L_t, L_x$ and spacing $a = a_x = a_t$. This implies a maximum momentum $p_\text{max} = \pi / a$ in each spacetime direction and $N_x=L_x/a, N_t=L_t/a$ points in each direction. Let us also define 
\begin{equation}
	\Lambda^2 \equiv (p^x_\text{max})^2 + (p^t_\text{max})^2,
\end{equation}
which indicates the maximum squared momentum on the given lattice. \\
We then consider a simulation with a regularised noise defined by a cutoff $\Lambda_\text{eff} \leq \Lambda$ and we define a dimensionless parameter
\begin{equation}
	s = \frac{\Lambda_\text{eff}}{\Lambda}, \qquad 0 \leq s \leq 1.
\end{equation}
Note that $\Lambda_\text{eff}$ implicitly defines a length scale given by  $a_\text{eff} = \pi/\Lambda_\text{eff}$.\\
Let us then consider a simulation with $s=1$ and a set of bare couplings $\{g^i_0\}$, and another simulation with $s'<1$ and new set of couplings $\{g^{i \, \prime}_0\}$. 
We now want to address the following question: is it possible to compensate the change in physical observables caused by the removal of the UV modes via regularised noise in the second simulation, by properly fine-tuning the bare parameters that enter the lattice discretised action? In other words, we want to encode the quantum fluctuations with $p^2 > \Lambda_\text{eff}^2$ in a redefitinion of the classical action so that the expectation value of the observables remains unchanged.\\
The issue is of course related to the renormalisation transformation introduced in chapter \ref{chap:background}. In particular we can exploit the connection between stochastic quantisation with coloured noise and the renormalisation group, as mentioned at the end of section \ref{sec:coloured_noise}, to accomplish the above mentioned goal. \\
As stated at the end of section \ref{sec:wilson_rg}, the Wilson RG flow of the dimensionless couplings and fields is dominated by the canonical scaling dimension of the corresponding dimensionful quantities, for high enough cutoff. 
We are interested in cooling the simulation by removing only the short-length fluctuations, hence we rely on this approximation as a lowest order Ansatz. This corresponds to a tree level RG rescaling. \\~\\
For what concerns the scalar part of the action, the rescaling at tree level is rather straightforward
\begin{equation*}
    \begin{aligned}
    \hat{m}_\phi^2 = (a^2m_\phi^2) \ \to \ s^2(a^2m_\phi^2) = s^2 \, \hat{m}_\phi^2, &\qquad \hat{\lambda} = (a^2\lambda) \ \to  \ s^2 (a^2\lambda) = s^2\hat{\lambda}, \\
    \hat\phi = \phi \ &\to \ \phi = \hat\phi.
    \end{aligned}
\end{equation*}
The fermionic part needs some more careful analysis. For simplicity, let us for the moment set $N_f = 1$. \\
In a lattice simulation one wants to perform the integral over the fermionic fields and works with the effective action \eqref{eq:effective_action_no_fermions}. In this case the drift is given by equation \eqref{eq:drift_continuum_full_theory}, with the fermionic contribution
\begin{equation}
    	K_{\psi} = g \, \underset{s}{\tr}{D^{-1}},
	\label{eq:fermionic_drift_contribution}
\end{equation}
or, in terms of dimensionless quantities,
\begin{equation*}
    \widehat{K}_{\psi} = (ag) \, \underset{s}{\tr}{(aD)^{-1}}.
\end{equation*}
This implies that under a lattice block-spin transformation, where $a \to sa$,
\begin{equation}
    \widehat{K}_{\psi} \to  (sag) \, \underset{s}{\tr}{(saD)^{-1}} = \widehat{K}_{\psi}
    \label{eq:fermionic_rescaling_na\"ive}
\end{equation}
On the other side, when computing the drift via the original action \eqref{eq:full_action_continuum}, one gets (omitting $\tau$ and $x$ dependency)
\begin{equation}
    \begin{aligned}
        K(\tau, x) &= - \frac{\delta S}{\delta \phi(\tau, x)} = K_\phi - g \, \bar\psi\psi = \\
        &= -\left(-\partial^2_x + m_\phi^2\right) \phi - \frac{\lambda}{6} \, \phi^3 - g \, \bar\psi\psi.
    \end{aligned}
    \label{eq:drift_continuum_from_full_action}
\end{equation}
where the fermionic contribution is given by
\begin{equation*}
    K_{\psi}' = - g \, \bar\psi\psi.
\end{equation*}
Note that all the terms in the equation \eqref{eq:drift_continuum_from_full_action} have dimension 2, in units of energy, which means, in particular, that after a lattice block-spin transformation where $a \to sa$, one has
\begin{equation}
    \widehat{K}'_\psi = (ag) (a\bar\psi \psi) \to s^2 (ag) (a\bar\psi \psi) = s^2 \widehat{K}'_\psi,
    \label{eq:rescaling_blinear}
\end{equation}
in contrast with \eqref{eq:fermionic_rescaling_na\"ive}. For this reason, in order to have the correct scaling, we compute the contribution to the drift without rescaling the Dirac operator (and hence the Yukawa coupling), and then rescale the whole drift via 
\begin{equation*}
    \widehat{K}_\psi \to s^2 \widehat{K}_\psi
\end{equation*}
so that the scaling dimension of the other terms in \eqref{eq:drift_continuum_from_full_action} is matched. \\~\\
We want to mention that this has important consequences on the issue of continuum limit of low-energy effective theories. In fact, in the standard lattice regularisation procedure, one always has $a \sim \Lambda^{-1}$, which means that the continuum limit $a \to 0$ is always connected to the limit $\Lambda \to \infty$, and this constitutes a problem for effective theories. The latter are in fact meant to be valid only up to a certain scale $\Lambda_\text{phys}$, hence one always needs $\Lambda \leq \Lambda_\text{phys}$. Cooling via coloured noise can provide a solution to this problem, since one can always keep the effective cutoff fixed at $\Lambda_\text{eff} = \Lambda_\text{phys}$, while taking the limits $a \to 0, \Lambda \to \infty$. 

\subsection*{Temperature control}
I have to wait for some results to see whether to include this or not :D

\section{Definition of relevant observables}
Fermionic two-points function
\begin{equation} 
\begin{aligned}
    \left\langle \psi_{s,f}(x) \, \bar\psi_{s',f'}(y) \right\rangle 
    &= \frac{1}{Z} \, \int \mathcal{D}\phi \, \mathcal{D}\psi \, \mathcal{D}\bar\psi \ \psi(x) \, \bar\psi(y) \, \exp \left( - S_\phi - \psi D \psi + \bar\eta \psi + \bar \psi \eta \right) \\
    &= \frac{1}{Z} \, \int \mathcal{D}\phi \, \mathcal{D}\psi \, \mathcal{D}\bar\psi \ \frac{\delta}{\delta \bar \eta(x)} \frac{\delta}{\delta \eta(y)} \, \exp \left( - S_\phi - \psi D \psi + \bar\eta \psi + \bar \psi \eta \right) \\
    &= \frac{1}{Z} \, \int \mathcal{D}\phi \ \text{det}\left[D(\phi)\right] \ \exp \left( - S_\phi \right) \ \frac{\delta}{\delta \bar \eta(x)} \frac{\delta}{\delta \eta(y)} \, \exp\left( \bar\eta D^{-1} \eta \right) \\
    &= \left\langle \left[D^{-1}(\phi)\right]_{s,s',f,f'}(x,y)\right\rangle
\end{aligned}
\label{eq:D_inv_condensate}
\end{equation}
The lattice version becomes
\begin{equation*}
     \left\langle \psi_m \, \bar\psi_n \right\rangle =     \left\langle \left[D^{-1}(\phi)\right]_{mn}\right\rangle
\end{equation*}
with $D$ beeing the Wilson Dirac operator. \\
From this, it follows straightforwardly
\begin{equation*}
    \left\langle  \bar\psi \psi \right\rangle = \underset{x,s,f}{\tr} D^{-1}
\end{equation*}
where $\left\langle  \bar\psi \psi \right\rangle = \underset{x,s,f}\sum  \left\langle \bar\psi_{s,f}(x) \, \psi_{s,f}(x) \right\rangle$. \\~\\
The correlator is defined as
\begin{align*}
    C(n_t,0) \equiv \frac{1}{N_x} \sum_{n_x} \left[\left\langle \psi(n_t, n_x) \, \bar\psi(0,0)\right\rangle + \left\langle \psi(N_t-n_t, n_x) \, \bar\psi(0,0) \right] \right\rangle
\end{align*}
Note that we sum up two waves because the source propagates both forward and backward in time due to the boundary conditions. \\
Since for $t \to \infty$ one has that $C(t,p) \propto e^{-E_0(p) t}$, we expect 
\begin{equation*}
    C(t,p) \approx \sinh \left(E_0 \left(\frac{N_t}{2} - t\right)\right)
\end{equation*}
magnetisation, susceptibility, binder cumulant